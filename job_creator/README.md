Autoreduction example:
```json
{
   "run_number":148871,
   "instrument":"OSIRIS",
   "experiment_title":"Experiment title",
   "experiment_number":"2220374",
   "filepath":"/archive/NDXOSIRIS/Instrument/data/cycle_24_2/OSIRIS00148871.nxs",
   "run_start":"2024-07-27T21:03:37",
   "run_end":"2024-07-28T13:32:08",
   "raw_frames":10,
   "good_frames":1,
   "users":"",
   "additional_values":{
      "cycle_string":"cycle_24_2",
      "freq6":50.0,
      "freq10":50.0,
      "phase6":8773.0,
      "phase10":14250.0,
      "tcb_detector_min":51500.0,
      "tcb_detector_max":71500.0,
      "tcb_monitor_min":46200.0,
      "tcb_monitor_max":66200.0,
      "reflection":"002",
      "calibration_run_number":"00148587",
      "spectroscopy_reduction":"true",
      "diffraction_reduction":"false",
      "analyser":"graphite",
      "input_runs":[
         148871
      ]
   }
}
```

Rerun (experiment ownership) example:

```json
{
  "job_id": 5984,
  "runner_image": "ghcr.io/fiaisis/mantid@sha256:6e5f2d070bb67742f354948d68f837a740874d230714eaa476d35ab6ad56caec",
  "experiment_number": "2220374",
  "script": "from mantid.simpleapi import *\nimport requests as requests\n\n\ndef generate_input_path_for_run(run_number, cycle):\n  return f\"/archive/ndxosiris/Instrument/data/{cycle}/OSI{run_number}.nxs\"\n\n\n# To change by automatic script\ninput_runs = [148871]\ncalibration_run_number = \"00148587\"\ncycle = \"cycle_24_2\"\nanalyser = \"graphite\"\nreflection = \"002\"\nspectroscopy_reduction = True\ndiffraction_reduction = False\n\nif not diffraction_reduction and not spectroscopy_reduction:\n  raise RuntimeError(\"diffraction_reduction and spectroscopy_reduction are both false, so this will do nothing.\")\n\n# Defaults and other generated inputs\ninstrument = \"OSIRIS\"\ninstrument_definition_directory = ConfigService.Instance().getString(\"instrumentDefinition.directory\")\ninstrument_filename = instrument_definition_directory + instrument + \"_Definition.xml\"\ninstrument_workspace = LoadEmptyInstrument(Filename=instrument_filename, OutputWorkspace=\"instrument_workspace\")\nparameter_filename = instrument_definition_directory + instrument + \"_\" + analyser + \"_\" + reflection + \"_Parameters.xml\"\nparameter_file = LoadParameterFile(Filename=parameter_filename, Workspace=\"instrument_workspace\")\nefixed = instrument_workspace.getInstrument().getComponentByName(analyser).getNumberParameter(\"Efixed\")[0]\nspec_spectra_range = \"963,1004\"\ndiff_spectra_range = '3,962'\nunit_x = \"DeltaE\"\nfold_multiple_frames = False\ndiffraction_calibration_file = \"/extras/osiris_041_RES10.cal\"\n\nsum_runs = len(input_runs) > 1\n\ninput_file_paths = \"\"\nfor input_run in input_runs:\n  input_file_paths += \", \" + generate_input_path_for_run(input_run, cycle)\ninput_file_paths = input_file_paths[2:]  # Slice out the excess \", \"\nprint(input_file_paths)\noutput_workspaces = []\n\n\n# Generate calibration workspace function\ndef generate_spec_calibration_workspace():\n  resolution = instrument_workspace.getInstrument().getComponentByName(analyser).getNumberParameter(\"resolution\", True)[0]\n  x = [-6 * resolution, -5 * resolution, -2 * resolution, 0, 2 * resolution]\n  y = [1, 2, 3, 4]\n  e = [0, 0, 0, 0]\n  energy_workspace = CreateWorkspace(DataX=x, DataY=y, DataE=e, NSpec=1, UnitX=\"DeltaE\", OutputWorkspace=\"energy_workspace\")\n  energy_workspace = ConvertToHistogram(InputWorkspace=\"energy_workspace\", OutputWorkspace=\"energy_workspace\")\n  LoadInstrument(Workspace=\"energy_workspace\", InstrumentName=instrument, RewriteSpectraMap=True)\n  LoadParameterFile(Filename=parameter_filename, Workspace=\"energy_workspace\")\n  spectra_min = energy_workspace.getInstrument().getNumberParameter(\"spectra-min\")[0]\n  spectrum = energy_workspace.getSpectrum(0)\n  spectrum.setSpectrumNo(int(spectra_min))\n  spectrum.clearDetectorIDs()\n  spectrum.addDetectorID(int(spectra_min))\n  tof_workspace = ConvertUnits(InputWorkspace=\"energy_workspace\", OutputWorkspace=\"tof_workspace\", Target=\"TOF\", EMode=\"Indirect\", EFixed=efixed)\n  tof_data = tof_workspace.readX(0)\n\n  calibration_input_files = \"OSIRIS\" + calibration_run_number + \".nxs\"\n  peak_range = f\"{tof_data[0]},{tof_data[2]}\"\n  background_range = f\"{tof_data[3]},{tof_data[4]}\"\n  calibration_workspace_name = \"osiris\" + calibration_run_number + \"_\" + analyser + reflection + \"_calib\"\n  return IndirectCalibration(InputFiles=calibration_input_files, DetectorRange=spec_spectra_range, PeakRange=peak_range, BackgroundRange=background_range, ScaleByFactor=0, ScaleFactor=1, LoadLogFiles=0, OutputWorkspace=calibration_workspace_name)\n\n# Perform the reduction\nif spectroscopy_reduction:\n  calibration_workspace = generate_spec_calibration_workspace()\n  output_workspace_prefix = instrument\n  for input_run in input_runs:\n      output_workspace_prefix += str(input_run) + \",\"\n  output_workspace_prefix = output_workspace_prefix[:-1] + f\"_{analyser}_{reflection}_Reduced\"  # Slice out the excess \",\" and finalize prefix\n  \n  output_spec_ws_individual = ISISIndirectEnergyTransferWrapper(OutputWorkspace=output_workspace_prefix + \"-individual\", GroupingMethod=\"Individual\", InputFiles=input_file_paths, SumFiles=sum_runs, CalibrationWorkspace=calibration_workspace, Instrument=instrument, Analyser=analyser, Reflection=reflection, EFixed=efixed, SpectraRange=spec_spectra_range, FoldMultipleFrames=fold_multiple_frames, UnitX=unit_x)\n\n  output_spec_ws_all = ISISIndirectEnergyTransferWrapper(OutputWorkspace=output_workspace_prefix + \"-all\", GroupingMethod=\"All\", InputFiles=input_file_paths, SumFiles=sum_runs, CalibrationWorkspace=calibration_workspace, Instrument=instrument, Analyser=analyser, Reflection=reflection, EFixed=efixed, SpectraRange=spec_spectra_range, FoldMultipleFrames=fold_multiple_frames, UnitX=unit_x)\n\n  output_workspaces.append(output_spec_ws_individual)\n  output_workspaces.append(output_spec_ws_all)\n\n  # Also perform the diffspec reduction using the diffraction algorithm\n  print(\"Reducing in diffspec mode using diffraction algorithm\")\n  output_diffspec_ws = ISISIndirectDiffractionReduction(InputFiles=input_file_paths, CalFile=diffraction_calibration_file, Instrument=instrument, SpectraRange=diff_spectra_range, OutputWorkspace=f\"{instrument}{input_runs[0]}_diffspec_red\")\n  output_workspaces.append(output_diffspec_ws)\n# \n# elif diffraction_reduction:\n#     print(\"Producing a diffraction reduction\")\n#     for run_number in input_runs:\n#         ws_name = instrument + run_number\n#         drange_ws = OSIRISDiffractionReduction(Sample=ws_name, CalFile=diffraction_calibration_file, OutputWorkspace=f'{ws_name}_dRange')\n#         q_ws = ConvertUnits(InputWorkspace=drange_ws, OutputWorkspace=f'{ws_name}_q', Target='QSquared')\n#         tof_ws = ConvertUnits(InputWorkspace=drange_ws, OutputWorkspace=f'{ws_name}_tof', Target='TOF')\n#         output_workspaces.append(drange_ws)\n#         output_workspaces.append(q_ws)\n#         output_workspaces.append(tof_ws)\n      \noutput = []\nfor workspace in output_workspaces:\n  save_file_name = f\"{workspace.name()}.nxs\"\n  save_path = f\"/output/{save_file_name}\"\n  SaveNexusProcessed(workspace, save_path)\n  output.append(save_file_name)\nimport json\n\nprint(json.dumps({'status': 'Successful', 'status_message': '', 'output_files': output, 'stacktrace': ''}))\n"
}
```

Rerun (user ownership) example:

```json
{
  "job_id": 5984,
  "runner_image": "ghcr.io/fiaisis/mantid@sha256:6e5f2d070bb67742f354948d68f837a740874d230714eaa476d35ab6ad56caec",
  "user_number": "100",
  "script": "from mantid.simpleapi import *\nimport requests as requests\n\n\ndef generate_input_path_for_run(run_number, cycle):\n  return f\"/archive/ndxosiris/Instrument/data/{cycle}/OSI{run_number}.nxs\"\n\n\n# To change by automatic script\ninput_runs = [148871]\ncalibration_run_number = \"00148587\"\ncycle = \"cycle_24_2\"\nanalyser = \"graphite\"\nreflection = \"002\"\nspectroscopy_reduction = True\ndiffraction_reduction = False\n\nif not diffraction_reduction and not spectroscopy_reduction:\n  raise RuntimeError(\"diffraction_reduction and spectroscopy_reduction are both false, so this will do nothing.\")\n\n# Defaults and other generated inputs\ninstrument = \"OSIRIS\"\ninstrument_definition_directory = ConfigService.Instance().getString(\"instrumentDefinition.directory\")\ninstrument_filename = instrument_definition_directory + instrument + \"_Definition.xml\"\ninstrument_workspace = LoadEmptyInstrument(Filename=instrument_filename, OutputWorkspace=\"instrument_workspace\")\nparameter_filename = instrument_definition_directory + instrument + \"_\" + analyser + \"_\" + reflection + \"_Parameters.xml\"\nparameter_file = LoadParameterFile(Filename=parameter_filename, Workspace=\"instrument_workspace\")\nefixed = instrument_workspace.getInstrument().getComponentByName(analyser).getNumberParameter(\"Efixed\")[0]\nspec_spectra_range = \"963,1004\"\ndiff_spectra_range = '3,962'\nunit_x = \"DeltaE\"\nfold_multiple_frames = False\ndiffraction_calibration_file = \"/extras/osiris_041_RES10.cal\"\n\nsum_runs = len(input_runs) > 1\n\ninput_file_paths = \"\"\nfor input_run in input_runs:\n  input_file_paths += \", \" + generate_input_path_for_run(input_run, cycle)\ninput_file_paths = input_file_paths[2:]  # Slice out the excess \", \"\nprint(input_file_paths)\noutput_workspaces = []\n\n\n# Generate calibration workspace function\ndef generate_spec_calibration_workspace():\n  resolution = instrument_workspace.getInstrument().getComponentByName(analyser).getNumberParameter(\"resolution\", True)[0]\n  x = [-6 * resolution, -5 * resolution, -2 * resolution, 0, 2 * resolution]\n  y = [1, 2, 3, 4]\n  e = [0, 0, 0, 0]\n  energy_workspace = CreateWorkspace(DataX=x, DataY=y, DataE=e, NSpec=1, UnitX=\"DeltaE\", OutputWorkspace=\"energy_workspace\")\n  energy_workspace = ConvertToHistogram(InputWorkspace=\"energy_workspace\", OutputWorkspace=\"energy_workspace\")\n  LoadInstrument(Workspace=\"energy_workspace\", InstrumentName=instrument, RewriteSpectraMap=True)\n  LoadParameterFile(Filename=parameter_filename, Workspace=\"energy_workspace\")\n  spectra_min = energy_workspace.getInstrument().getNumberParameter(\"spectra-min\")[0]\n  spectrum = energy_workspace.getSpectrum(0)\n  spectrum.setSpectrumNo(int(spectra_min))\n  spectrum.clearDetectorIDs()\n  spectrum.addDetectorID(int(spectra_min))\n  tof_workspace = ConvertUnits(InputWorkspace=\"energy_workspace\", OutputWorkspace=\"tof_workspace\", Target=\"TOF\", EMode=\"Indirect\", EFixed=efixed)\n  tof_data = tof_workspace.readX(0)\n\n  calibration_input_files = \"OSIRIS\" + calibration_run_number + \".nxs\"\n  peak_range = f\"{tof_data[0]},{tof_data[2]}\"\n  background_range = f\"{tof_data[3]},{tof_data[4]}\"\n  calibration_workspace_name = \"osiris\" + calibration_run_number + \"_\" + analyser + reflection + \"_calib\"\n  return IndirectCalibration(InputFiles=calibration_input_files, DetectorRange=spec_spectra_range, PeakRange=peak_range, BackgroundRange=background_range, ScaleByFactor=0, ScaleFactor=1, LoadLogFiles=0, OutputWorkspace=calibration_workspace_name)\n\n# Perform the reduction\nif spectroscopy_reduction:\n  calibration_workspace = generate_spec_calibration_workspace()\n  output_workspace_prefix = instrument\n  for input_run in input_runs:\n      output_workspace_prefix += str(input_run) + \",\"\n  output_workspace_prefix = output_workspace_prefix[:-1] + f\"_{analyser}_{reflection}_Reduced\"  # Slice out the excess \",\" and finalize prefix\n  \n  output_spec_ws_individual = ISISIndirectEnergyTransferWrapper(OutputWorkspace=output_workspace_prefix + \"-individual\", GroupingMethod=\"Individual\", InputFiles=input_file_paths, SumFiles=sum_runs, CalibrationWorkspace=calibration_workspace, Instrument=instrument, Analyser=analyser, Reflection=reflection, EFixed=efixed, SpectraRange=spec_spectra_range, FoldMultipleFrames=fold_multiple_frames, UnitX=unit_x)\n\n  output_spec_ws_all = ISISIndirectEnergyTransferWrapper(OutputWorkspace=output_workspace_prefix + \"-all\", GroupingMethod=\"All\", InputFiles=input_file_paths, SumFiles=sum_runs, CalibrationWorkspace=calibration_workspace, Instrument=instrument, Analyser=analyser, Reflection=reflection, EFixed=efixed, SpectraRange=spec_spectra_range, FoldMultipleFrames=fold_multiple_frames, UnitX=unit_x)\n\n  output_workspaces.append(output_spec_ws_individual)\n  output_workspaces.append(output_spec_ws_all)\n\n  # Also perform the diffspec reduction using the diffraction algorithm\n  print(\"Reducing in diffspec mode using diffraction algorithm\")\n  output_diffspec_ws = ISISIndirectDiffractionReduction(InputFiles=input_file_paths, CalFile=diffraction_calibration_file, Instrument=instrument, SpectraRange=diff_spectra_range, OutputWorkspace=f\"{instrument}{input_runs[0]}_diffspec_red\")\n  output_workspaces.append(output_diffspec_ws)\n# \n# elif diffraction_reduction:\n#     print(\"Producing a diffraction reduction\")\n#     for run_number in input_runs:\n#         ws_name = instrument + run_number\n#         drange_ws = OSIRISDiffractionReduction(Sample=ws_name, CalFile=diffraction_calibration_file, OutputWorkspace=f'{ws_name}_dRange')\n#         q_ws = ConvertUnits(InputWorkspace=drange_ws, OutputWorkspace=f'{ws_name}_q', Target='QSquared')\n#         tof_ws = ConvertUnits(InputWorkspace=drange_ws, OutputWorkspace=f'{ws_name}_tof', Target='TOF')\n#         output_workspaces.append(drange_ws)\n#         output_workspaces.append(q_ws)\n#         output_workspaces.append(tof_ws)\n      \noutput = []\nfor workspace in output_workspaces:\n  save_file_name = f\"{workspace.name()}.nxs\"\n  save_path = f\"/output/{save_file_name}\"\n  SaveNexusProcessed(workspace, save_path)\n  output.append(save_file_name)\nimport json\n\nprint(json.dumps({'status': 'Successful', 'status_message': '', 'output_files': output, 'stacktrace': ''}))\n"
}
```

Simple (experiment ownership) example:
```json
{
  "runner_image": "ghcr.io/fiaisis/mantid@sha256:6e5f2d070bb67742f354948d68f837a740874d230714eaa476d35ab6ad56caec",
  "experiment_number": "2220374",
  "script": "from mantid.simpleapi import *\nimport requests as requests\n\n\ndef generate_input_path_for_run(run_number, cycle):\n  return f\"/archive/ndxosiris/Instrument/data/{cycle}/OSI{run_number}.nxs\"\n\n\n# To change by automatic script\ninput_runs = [148871]\ncalibration_run_number = \"00148587\"\ncycle = \"cycle_24_2\"\nanalyser = \"graphite\"\nreflection = \"002\"\nspectroscopy_reduction = True\ndiffraction_reduction = False\n\nif not diffraction_reduction and not spectroscopy_reduction:\n  raise RuntimeError(\"diffraction_reduction and spectroscopy_reduction are both false, so this will do nothing.\")\n\n# Defaults and other generated inputs\ninstrument = \"OSIRIS\"\ninstrument_definition_directory = ConfigService.Instance().getString(\"instrumentDefinition.directory\")\ninstrument_filename = instrument_definition_directory + instrument + \"_Definition.xml\"\ninstrument_workspace = LoadEmptyInstrument(Filename=instrument_filename, OutputWorkspace=\"instrument_workspace\")\nparameter_filename = instrument_definition_directory + instrument + \"_\" + analyser + \"_\" + reflection + \"_Parameters.xml\"\nparameter_file = LoadParameterFile(Filename=parameter_filename, Workspace=\"instrument_workspace\")\nefixed = instrument_workspace.getInstrument().getComponentByName(analyser).getNumberParameter(\"Efixed\")[0]\nspec_spectra_range = \"963,1004\"\ndiff_spectra_range = '3,962'\nunit_x = \"DeltaE\"\nfold_multiple_frames = False\ndiffraction_calibration_file = \"/extras/osiris_041_RES10.cal\"\n\nsum_runs = len(input_runs) > 1\n\ninput_file_paths = \"\"\nfor input_run in input_runs:\n  input_file_paths += \", \" + generate_input_path_for_run(input_run, cycle)\ninput_file_paths = input_file_paths[2:]  # Slice out the excess \", \"\nprint(input_file_paths)\noutput_workspaces = []\n\n\n# Generate calibration workspace function\ndef generate_spec_calibration_workspace():\n  resolution = instrument_workspace.getInstrument().getComponentByName(analyser).getNumberParameter(\"resolution\", True)[0]\n  x = [-6 * resolution, -5 * resolution, -2 * resolution, 0, 2 * resolution]\n  y = [1, 2, 3, 4]\n  e = [0, 0, 0, 0]\n  energy_workspace = CreateWorkspace(DataX=x, DataY=y, DataE=e, NSpec=1, UnitX=\"DeltaE\", OutputWorkspace=\"energy_workspace\")\n  energy_workspace = ConvertToHistogram(InputWorkspace=\"energy_workspace\", OutputWorkspace=\"energy_workspace\")\n  LoadInstrument(Workspace=\"energy_workspace\", InstrumentName=instrument, RewriteSpectraMap=True)\n  LoadParameterFile(Filename=parameter_filename, Workspace=\"energy_workspace\")\n  spectra_min = energy_workspace.getInstrument().getNumberParameter(\"spectra-min\")[0]\n  spectrum = energy_workspace.getSpectrum(0)\n  spectrum.setSpectrumNo(int(spectra_min))\n  spectrum.clearDetectorIDs()\n  spectrum.addDetectorID(int(spectra_min))\n  tof_workspace = ConvertUnits(InputWorkspace=\"energy_workspace\", OutputWorkspace=\"tof_workspace\", Target=\"TOF\", EMode=\"Indirect\", EFixed=efixed)\n  tof_data = tof_workspace.readX(0)\n\n  calibration_input_files = \"OSIRIS\" + calibration_run_number + \".nxs\"\n  peak_range = f\"{tof_data[0]},{tof_data[2]}\"\n  background_range = f\"{tof_data[3]},{tof_data[4]}\"\n  calibration_workspace_name = \"osiris\" + calibration_run_number + \"_\" + analyser + reflection + \"_calib\"\n  return IndirectCalibration(InputFiles=calibration_input_files, DetectorRange=spec_spectra_range, PeakRange=peak_range, BackgroundRange=background_range, ScaleByFactor=0, ScaleFactor=1, LoadLogFiles=0, OutputWorkspace=calibration_workspace_name)\n\n# Perform the reduction\nif spectroscopy_reduction:\n  calibration_workspace = generate_spec_calibration_workspace()\n  output_workspace_prefix = instrument\n  for input_run in input_runs:\n      output_workspace_prefix += str(input_run) + \",\"\n  output_workspace_prefix = output_workspace_prefix[:-1] + f\"_{analyser}_{reflection}_Reduced\"  # Slice out the excess \",\" and finalize prefix\n  \n  output_spec_ws_individual = ISISIndirectEnergyTransferWrapper(OutputWorkspace=output_workspace_prefix + \"-individual\", GroupingMethod=\"Individual\", InputFiles=input_file_paths, SumFiles=sum_runs, CalibrationWorkspace=calibration_workspace, Instrument=instrument, Analyser=analyser, Reflection=reflection, EFixed=efixed, SpectraRange=spec_spectra_range, FoldMultipleFrames=fold_multiple_frames, UnitX=unit_x)\n\n  output_spec_ws_all = ISISIndirectEnergyTransferWrapper(OutputWorkspace=output_workspace_prefix + \"-all\", GroupingMethod=\"All\", InputFiles=input_file_paths, SumFiles=sum_runs, CalibrationWorkspace=calibration_workspace, Instrument=instrument, Analyser=analyser, Reflection=reflection, EFixed=efixed, SpectraRange=spec_spectra_range, FoldMultipleFrames=fold_multiple_frames, UnitX=unit_x)\n\n  output_workspaces.append(output_spec_ws_individual)\n  output_workspaces.append(output_spec_ws_all)\n\n  # Also perform the diffspec reduction using the diffraction algorithm\n  print(\"Reducing in diffspec mode using diffraction algorithm\")\n  output_diffspec_ws = ISISIndirectDiffractionReduction(InputFiles=input_file_paths, CalFile=diffraction_calibration_file, Instrument=instrument, SpectraRange=diff_spectra_range, OutputWorkspace=f\"{instrument}{input_runs[0]}_diffspec_red\")\n  output_workspaces.append(output_diffspec_ws)\n# \n# elif diffraction_reduction:\n#     print(\"Producing a diffraction reduction\")\n#     for run_number in input_runs:\n#         ws_name = instrument + run_number\n#         drange_ws = OSIRISDiffractionReduction(Sample=ws_name, CalFile=diffraction_calibration_file, OutputWorkspace=f'{ws_name}_dRange')\n#         q_ws = ConvertUnits(InputWorkspace=drange_ws, OutputWorkspace=f'{ws_name}_q', Target='QSquared')\n#         tof_ws = ConvertUnits(InputWorkspace=drange_ws, OutputWorkspace=f'{ws_name}_tof', Target='TOF')\n#         output_workspaces.append(drange_ws)\n#         output_workspaces.append(q_ws)\n#         output_workspaces.append(tof_ws)\n      \noutput = []\nfor workspace in output_workspaces:\n  save_file_name = f\"{workspace.name()}.nxs\"\n  save_path = f\"/output/{save_file_name}\"\n  SaveNexusProcessed(workspace, save_path)\n  output.append(save_file_name)\nimport json\n\nprint(json.dumps({'status': 'Successful', 'status_message': '', 'output_files': output, 'stacktrace': ''}))\n"
}
```

Simple (user ownership) example:
```json
{
  "runner_image": "ghcr.io/fiaisis/mantid@sha256:6e5f2d070bb67742f354948d68f837a740874d230714eaa476d35ab6ad56caec",
  "user_number": "100",
  "script": "from mantid.simpleapi import *\nimport requests as requests\n\n\ndef generate_input_path_for_run(run_number, cycle):\n  return f\"/archive/ndxosiris/Instrument/data/{cycle}/OSI{run_number}.nxs\"\n\n\n# To change by automatic script\ninput_runs = [148871]\ncalibration_run_number = \"00148587\"\ncycle = \"cycle_24_2\"\nanalyser = \"graphite\"\nreflection = \"002\"\nspectroscopy_reduction = True\ndiffraction_reduction = False\n\nif not diffraction_reduction and not spectroscopy_reduction:\n  raise RuntimeError(\"diffraction_reduction and spectroscopy_reduction are both false, so this will do nothing.\")\n\n# Defaults and other generated inputs\ninstrument = \"OSIRIS\"\ninstrument_definition_directory = ConfigService.Instance().getString(\"instrumentDefinition.directory\")\ninstrument_filename = instrument_definition_directory + instrument + \"_Definition.xml\"\ninstrument_workspace = LoadEmptyInstrument(Filename=instrument_filename, OutputWorkspace=\"instrument_workspace\")\nparameter_filename = instrument_definition_directory + instrument + \"_\" + analyser + \"_\" + reflection + \"_Parameters.xml\"\nparameter_file = LoadParameterFile(Filename=parameter_filename, Workspace=\"instrument_workspace\")\nefixed = instrument_workspace.getInstrument().getComponentByName(analyser).getNumberParameter(\"Efixed\")[0]\nspec_spectra_range = \"963,1004\"\ndiff_spectra_range = '3,962'\nunit_x = \"DeltaE\"\nfold_multiple_frames = False\ndiffraction_calibration_file = \"/extras/osiris_041_RES10.cal\"\n\nsum_runs = len(input_runs) > 1\n\ninput_file_paths = \"\"\nfor input_run in input_runs:\n  input_file_paths += \", \" + generate_input_path_for_run(input_run, cycle)\ninput_file_paths = input_file_paths[2:]  # Slice out the excess \", \"\nprint(input_file_paths)\noutput_workspaces = []\n\n\n# Generate calibration workspace function\ndef generate_spec_calibration_workspace():\n  resolution = instrument_workspace.getInstrument().getComponentByName(analyser).getNumberParameter(\"resolution\", True)[0]\n  x = [-6 * resolution, -5 * resolution, -2 * resolution, 0, 2 * resolution]\n  y = [1, 2, 3, 4]\n  e = [0, 0, 0, 0]\n  energy_workspace = CreateWorkspace(DataX=x, DataY=y, DataE=e, NSpec=1, UnitX=\"DeltaE\", OutputWorkspace=\"energy_workspace\")\n  energy_workspace = ConvertToHistogram(InputWorkspace=\"energy_workspace\", OutputWorkspace=\"energy_workspace\")\n  LoadInstrument(Workspace=\"energy_workspace\", InstrumentName=instrument, RewriteSpectraMap=True)\n  LoadParameterFile(Filename=parameter_filename, Workspace=\"energy_workspace\")\n  spectra_min = energy_workspace.getInstrument().getNumberParameter(\"spectra-min\")[0]\n  spectrum = energy_workspace.getSpectrum(0)\n  spectrum.setSpectrumNo(int(spectra_min))\n  spectrum.clearDetectorIDs()\n  spectrum.addDetectorID(int(spectra_min))\n  tof_workspace = ConvertUnits(InputWorkspace=\"energy_workspace\", OutputWorkspace=\"tof_workspace\", Target=\"TOF\", EMode=\"Indirect\", EFixed=efixed)\n  tof_data = tof_workspace.readX(0)\n\n  calibration_input_files = \"OSIRIS\" + calibration_run_number + \".nxs\"\n  peak_range = f\"{tof_data[0]},{tof_data[2]}\"\n  background_range = f\"{tof_data[3]},{tof_data[4]}\"\n  calibration_workspace_name = \"osiris\" + calibration_run_number + \"_\" + analyser + reflection + \"_calib\"\n  return IndirectCalibration(InputFiles=calibration_input_files, DetectorRange=spec_spectra_range, PeakRange=peak_range, BackgroundRange=background_range, ScaleByFactor=0, ScaleFactor=1, LoadLogFiles=0, OutputWorkspace=calibration_workspace_name)\n\n# Perform the reduction\nif spectroscopy_reduction:\n  calibration_workspace = generate_spec_calibration_workspace()\n  output_workspace_prefix = instrument\n  for input_run in input_runs:\n      output_workspace_prefix += str(input_run) + \",\"\n  output_workspace_prefix = output_workspace_prefix[:-1] + f\"_{analyser}_{reflection}_Reduced\"  # Slice out the excess \",\" and finalize prefix\n  \n  output_spec_ws_individual = ISISIndirectEnergyTransferWrapper(OutputWorkspace=output_workspace_prefix + \"-individual\", GroupingMethod=\"Individual\", InputFiles=input_file_paths, SumFiles=sum_runs, CalibrationWorkspace=calibration_workspace, Instrument=instrument, Analyser=analyser, Reflection=reflection, EFixed=efixed, SpectraRange=spec_spectra_range, FoldMultipleFrames=fold_multiple_frames, UnitX=unit_x)\n\n  output_spec_ws_all = ISISIndirectEnergyTransferWrapper(OutputWorkspace=output_workspace_prefix + \"-all\", GroupingMethod=\"All\", InputFiles=input_file_paths, SumFiles=sum_runs, CalibrationWorkspace=calibration_workspace, Instrument=instrument, Analyser=analyser, Reflection=reflection, EFixed=efixed, SpectraRange=spec_spectra_range, FoldMultipleFrames=fold_multiple_frames, UnitX=unit_x)\n\n  output_workspaces.append(output_spec_ws_individual)\n  output_workspaces.append(output_spec_ws_all)\n\n  # Also perform the diffspec reduction using the diffraction algorithm\n  print(\"Reducing in diffspec mode using diffraction algorithm\")\n  output_diffspec_ws = ISISIndirectDiffractionReduction(InputFiles=input_file_paths, CalFile=diffraction_calibration_file, Instrument=instrument, SpectraRange=diff_spectra_range, OutputWorkspace=f\"{instrument}{input_runs[0]}_diffspec_red\")\n  output_workspaces.append(output_diffspec_ws)\n# \n# elif diffraction_reduction:\n#     print(\"Producing a diffraction reduction\")\n#     for run_number in input_runs:\n#         ws_name = instrument + run_number\n#         drange_ws = OSIRISDiffractionReduction(Sample=ws_name, CalFile=diffraction_calibration_file, OutputWorkspace=f'{ws_name}_dRange')\n#         q_ws = ConvertUnits(InputWorkspace=drange_ws, OutputWorkspace=f'{ws_name}_q', Target='QSquared')\n#         tof_ws = ConvertUnits(InputWorkspace=drange_ws, OutputWorkspace=f'{ws_name}_tof', Target='TOF')\n#         output_workspaces.append(drange_ws)\n#         output_workspaces.append(q_ws)\n#         output_workspaces.append(tof_ws)\n      \noutput = []\nfor workspace in output_workspaces:\n  save_file_name = f\"{workspace.name()}.nxs\"\n  save_path = f\"/output/{save_file_name}\"\n  SaveNexusProcessed(workspace, save_path)\n  output.append(save_file_name)\nimport json\n\nprint(json.dumps({'status': 'Successful', 'status_message': '', 'output_files': output, 'stacktrace': ''}))\n"
}
```

# How to process anything using the cluster's resources with the jobcreator:

Simple (this shouldn't be done example):
```json
{
  "runner_image": "ghcr.io/pasarus/simple-runner@sha256:955c5fc0a00e094a26c151c6a8756c799c88116011ede261903022a36170d337",
  "user_number": "1102833",
  "script": "import pandas as pd\nuri = \"https://github.com/owid/owid-datasets/raw/master/datasets/Global%20average%20temperature%20anomaly%20-%20Hadley%20Centre/Global%20average%20temperature%20anomaly%20-%20Hadley%20Centre.csv\"\ndata = pd.read_csv(uri)\ndata = data.rename(columns={\"Global average temperature anomaly (Hadley Centre)\": \"Global\"})\ndata = data[data.Entity == \"median\"]\n\nfrom uniplot import plot\nplot(xs=data.Year, ys=data.Global, lines=True, title=\"Global normalized land-sea temperature anomaly\", y_unit=\" °C\")\n"
}
```

The script used in above from https://github.com/olavolav/uniplot
```python
import pandas as pd
uri = "https://github.com/owid/owid-datasets/raw/master/datasets/Global%20average%20temperature%20anomaly%20-%20Hadley%20Centre/Global%20average%20temperature%20anomaly%20-%20Hadley%20Centre.csv"
data = pd.read_csv(uri)
data = data.rename(columns={"Global average temperature anomaly (Hadley Centre)": "Global"})
data = data[data.Entity == "median"]

from uniplot import plot
plot(xs=data.Year, ys=data.Global, lines=True, title="Global normalized land-sea temperature anomaly", y_unit=" °C")
```

Docker file script for Simple anyone can process any python script
```dockerfile
FROM python:3.12.3-slim

RUN pip install pandas uniplot

# The secret sauce here is to have this at the end of a runner's dockerfile
RUN echo '#!/bin/bash\npython -c "$@"' > /entrypoint.sh
RUN chmod +x /entrypoint.sh
ENTRYPOINT ["/entrypoint.sh"]
```

You can also do something less useful like print the time and then exit:
```json
{
  "runner_image": "ghcr.io/pasarus/simple-runner@sha256:955c5fc0a00e094a26c151c6a8756c799c88116011ede261903022a36170d337",
  "user_number": "1102833",
  "script": "from datetime import datetime\nprint(\"Current time: \" + datetime.now().strftime(\"%H:%M:%S\"))"
}
```